<main>
  <h1>AdeMETEO</h1>

  <!-- Blocco ricerca + previsioni attuali -->
  <section class="left-block" aria-label="Search & Current Weather">
    <div class="search-container">
      <label for="city">CittÃ </label>
      <input id="city" name="city" [(ngModel)]="city" placeholder="Es. Rome" />
      <button (click)="search()" [disabled]="loading()">Cerca</button>
      <button (click)="refresh()" [disabled]="loading() || !location()">Aggiorna</button>
    </div>

    <section *ngIf="loading()" aria-live="polite">
      <p>Caricamento...</p>
    </section>

    <section *ngIf="error()" role="alert">
      <p>{{ error() }}</p>
      <button (click)="search()">Riprova</button>
    </section>

    <section *ngIf="location() && weather()">
      <h2>{{ location()?.name }}</h2>

      <div class="current">
        <p>ğŸŒ¡ï¸ Temperatura attuale: {{ weather().current_weather.temperature }} Â°C</p>
        <p>ğŸ’¨ Vento: {{ weather().current_weather.windspeed }} km/h</p>
        <p>â˜ï¸ Condizione: {{ getWeatherDescription(weather().current_weather.weathercode) }}</p>
      </div>
    </section>
  </section>

  <!-- Blocco previsioni future -->
  <section class="right-block" *ngIf="location() && weather()">
    <h3>ğŸ“… Previsioni giornaliere</h3>
    <ul>
      <li *ngFor="let day of weather().daily.time; let i = index">
        <button (click)="toggleDay(i)">
          {{ day }} â€” max: {{ weather().daily.temperature_2m_max[i] }}Â°C, min: {{ weather().daily.temperature_2m_min[i] }}Â°C
        </button>
        <div *ngIf="expandedDayIndex() === i">
          <p>ğŸŒ§ï¸ Precipitazioni totali: {{ weather().daily.precipitation_sum[i] }} mm</p>
          <p>â˜ï¸ Condizione: {{ getWeatherDescription(weather().daily.weathercode[i]) }}</p>
        </div>
      </li>
    </ul>
  </section>

</main>

<router-outlet />
